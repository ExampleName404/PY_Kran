# ü§ñ Visual Reinforcement Learning - –û–±—É—á–µ–Ω–∏–µ —Ä–æ–±–æ—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è —Ä–æ–±–æ—Ç–∞-–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–∞ **Kuka IIWA** —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å—Ö–≤–∞—Ç–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –∫–∞–º–µ—Ä. –†–æ–±–æ—Ç —É—á–∏—Ç—Å—è –¥–æ—Å—Ç–∏–≥–∞—Ç—å —Ü–µ–ª–µ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (–∂–µ–ª—Ç—ã–π –∫—É–±), –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª–æ–∂–µ–Ω–∏–∏ —Å—É—Å—Ç–∞–≤–æ–≤.

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. **–°—Ä–µ–¥–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ (PyBullet)**
- –§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–∏–º—É–ª—è—Ç–æ—Ä —Å —Ä–æ–±–æ—Ç–æ–º Kuka IIWA (7 —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã)
- –¢–µ–º–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å-—Å—Ç–æ–ª –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
- –Ø—Ä–∫–æ-–∂–µ–ª—Ç—ã–π —Ü–µ–ª–µ–≤–æ–π –∫—É–± (—Ö–æ—Ä–æ—à–æ –≤–∏–¥–µ–Ω –Ω–∞ —á/–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏)
- –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∫—É–±–∞ –≤ —Ä–∞–±–æ—á–µ–π –∑–æ–Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —ç–ø–∏–∑–æ–¥–µ

### 2. **–°—Ç–µ—Ä–µ–æ–∑—Ä–µ–Ω–∏–µ (2 –∫–∞–º–µ—Ä—ã)** üëÅÔ∏èüëÅÔ∏è
- **–õ–µ–≤–∞—è –∫–∞–º–µ—Ä–∞**: –ø–æ–∑–∏—Ü–∏—è `[0.45, -0.1, 1.0]`
- **–ü—Ä–∞–≤–∞—è –∫–∞–º–µ—Ä–∞**: –ø–æ–∑–∏—Ü–∏—è `[0.45, 0.1, 1.0]`
- –û–±–µ —Å–º–æ—Ç—Ä—è—Ç —Å–≤–µ—Ä—Ö—É –Ω–∞ —Ä–∞–±–æ—á—É—é –∑–æ–Ω—É
- –°—Ç–µ—Ä–µ–æ–∑—Ä–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å **–≥–ª—É–±–∏–Ω—É –∏ 3D-–ø–æ–ª–æ–∂–µ–Ω–∏–µ** –æ–±—ä–µ–∫—Ç–æ–≤
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 64√ó64 –ø–∏–∫—Å–µ–ª–µ–π –≤ –≥—Ä–∞–¥–∞—Ü–∏—è—Ö —Å–µ—Ä–æ–≥–æ (—ç–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤)

### 3. **–ù–∞–±–ª—é–¥–µ–Ω–∏—è (Observations)**
–†–æ–±–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç:
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: 2 –∫–∞–Ω–∞–ª–∞ (–ª–µ–≤–∞—è + –ø—Ä–∞–≤–∞—è –∫–∞–º–µ—Ä–∞), —Ä–∞–∑–º–µ—Ä 64√ó64
- **–£–≥–ª—ã —Å—É—Å—Ç–∞–≤–æ–≤**: 7 –∑–Ω–∞—á–µ–Ω–∏–π (–ø—Ä–æ–ø—Ä–∏–æ—Ü–µ–ø—Ü–∏—è - "–æ—â—É—â–µ–Ω–∏–µ" –ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–µ–ª–∞)

### 4. **–î–µ–π—Å—Ç–≤–∏—è (Actions)**
–†–æ–±–æ—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑:
- **–°–º–µ—â–µ–Ω–∏–µ —Å—Ö–≤–∞—Ç–∞** –≤ 3D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ: `(dx, dy, dz)`
- –î–∏–∞–ø–∞–∑–æ–Ω: –æ—Ç -0.05 –¥–æ +0.05 –º–µ—Ç—Ä–æ–≤ –∑–∞ —à–∞–≥
- Inverse Kinematics –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —É–≥–ª—ã —Å—É—Å—Ç–∞–≤–æ–≤

### 5. **–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (NatureCNN)**

```
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí CNN (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π) ‚Üí –ü—Ä–∏–∑–Ω–∞–∫–∏
                                                    ‚Üì
–£–≥–ª—ã —Å—É—Å—Ç–∞–≤–æ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ ‚Üí Policy & Value –≥–æ–ª–æ–≤—ã
```

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ CNN:**
- Conv2D (2‚Üí32 –∫–∞–Ω–∞–ª–æ–≤, 3√ó3, stride=2) ‚Üí 32√ó32
- Conv2D (32‚Üí64 –∫–∞–Ω–∞–ª–æ–≤, 3√ó3, stride=2) ‚Üí 16√ó16
- Conv2D (64‚Üí64 –∫–∞–Ω–∞–ª–æ–≤, 3√ó3, stride=1) ‚Üí 16√ó16
- Flatten ‚Üí –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π (+ —É–≥–ª—ã) ‚Üí 256 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

### 6. **–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—É—á–µ–Ω–∏—è: PPO (Proximal Policy Optimization)**
- **–ù–∞–≥—Ä–∞–¥—ã**:
  - `-2.0 √ó —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ` –¥–æ —Ü–µ–ª–∏ (—Å—Ç–∏–º—É–ª –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å—Å—è)
  - `+10.0` –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞
  - `+50.0` –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ < 5 —Å–º)
  - `-0.01` –∑–∞ –∫–∞–∂–¥—ã–π —à–∞–≥ (—Å—Ç–∏–º—É–ª –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–æ)

- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã PPO**:
  - Learning rate: `3e-4`
  - Batch size: `64`
  - Epochs: `10`
  - Total timesteps: `500,000` (~245 —ç–ø–∏–∑–æ–¥–æ–≤)

### 7. **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ GPU** üöÄ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CUDA –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
- –û–±—É—á–µ–Ω–∏–µ –≤ 10-50 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ —á–µ–º –Ω–∞ CPU
- PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA 12.6

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:
```powershell
python visual_rl_robot.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:
```powershell
python visual_rl_robot.py test
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è (TensorBoard):
```powershell
tensorboard --logdir ./logs/visual_rl/
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
PY_Kran/
‚îú‚îÄ‚îÄ visual_rl_robot.py      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
‚îú‚îÄ‚îÄ models/                  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ visual_rl_robot.zip
‚îú‚îÄ‚îÄ logs/                    # –õ–æ–≥–∏ TensorBoard
‚îÇ   ‚îî‚îÄ‚îÄ visual_rl/
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Observation Space:
```python
Dict({
    'image': Box(0, 255, (64, 64, 2), uint8),    # –°—Ç–µ—Ä–µ–æ–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    'joints': Box(-œÄ, œÄ, (7,), float32)           # –£–≥–ª—ã —Å—É—Å—Ç–∞–≤–æ–≤
})
```

### Action Space:
```python
Box(-0.05, 0.05, (3,), float32)  # –°–º–µ—â–µ–Ω–∏–µ (dx, dy, dz)
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏:
- **Frame skip**: 4 (–ø–æ–≤—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è)
- **Max steps**: 100 —à–∞–≥–æ–≤ –Ω–∞ —ç–ø–∏–∑–æ–¥
- **–†–∞–±–æ—á–∞—è –∑–æ–Ω–∞**: x ‚àà [0.3, 0.7], y ‚àà [-0.3, 0.3], z = 0.5

## üß† –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç**: –ñ–µ–ª—Ç—ã–π –∫—É–± –Ω–∞ —Ç–µ–º–Ω–æ–º —Ñ–æ–Ω–µ ‚Üí —è—Ä–∫–æ–µ –±–µ–ª–æ–µ –ø—è—Ç–Ω–æ –Ω–∞ —á/–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
2. **–°—Ç–µ—Ä–µ–æ–∑—Ä–µ–Ω–∏–µ**: –î–≤–µ –∫–∞–º–µ—Ä—ã –¥–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–ª—É–±–∏–Ω–µ (–∫–∞–∫ —É —á–µ–ª–æ–≤–µ–∫–∞)
3. **Dense rewards**: –ù–∞–≥—Ä–∞–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è ‚Üí –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
4. **–ü—Ä–æ–ø—Ä–∏–æ—Ü–µ–ø—Ü–∏—è**: –£–≥–ª—ã —Å—É—Å—Ç–∞–≤–æ–≤ –ø–æ–º–æ–≥–∞—é—Ç —Å–µ—Ç–∏ –ø–æ–Ω–∏–º–∞—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–æ–±–æ—Ç–∞
5. **CNN**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —Ñ–æ—Ä–º—É –æ–±—ä–µ–∫—Ç–∞)

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ ~500k —à–∞–≥–æ–≤ —Ä–æ–±–æ—Ç –Ω–∞—É—á–∏—Ç—Å—è:
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç—å —Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
- ‚úÖ –û—Ü–µ–Ω–∏–≤–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –Ω–µ–≥–æ (—Å—Ç–µ—Ä–µ–æ–∑—Ä–µ–Ω–∏–µ)
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é –¥–≤–∏–∂–µ–Ω–∏—è —Å—Ö–≤–∞—Ç–∞
- ‚úÖ –î–æ—Å—Ç–∏–≥–∞—Ç—å –æ–±—ä–µ–∫—Ç –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install gymnasium pybullet stable-baselines3 torch torchvision numpy opencv-python rich tqdm
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu126  # –î–ª—è GPU
```

## üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **–ë–µ–∑ VecFrameStack**: –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å Dict observation space
- **Normalize_images=False**: –†—É—á–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ CNN
- **–ú–∞–ª—ã–µ —è–¥—Ä–∞ —Å–≤–µ—Ä—Ç–∫–∏ (3√ó3)**: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π 64√ó64
- **–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ GPU**: –ö–æ–¥ —Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç CUDA –∏–ª–∏ CPU

## üéì –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

–≠—Ç–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
- –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–µ (—Å–±–æ—Ä–∫–∞, —É–ø–∞–∫–æ–≤–∫–∞)
- –ê–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (–¥—Ä–æ–Ω—ã, —Ä–æ–±–æ—Ç—ã-–¥–æ—Å—Ç–∞–≤—â–∏–∫–∏)
- –ú–µ–¥–∏—Ü–∏–Ω–µ (—Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–µ —Ä–æ–±–æ—Ç—ã)
- –ö–æ—Å–º–æ—Å–µ (–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä—ã –Ω–∞ –ú–ö–°, –º–∞—Ä—Å–æ—Ö–æ–¥—ã)

---

**–ê–≤—Ç–æ—Ä**: Visual RL Lab  
**–î–∞—Ç–∞**: –ù–æ—è–±—Ä—å 2025  
**–õ–∏—Ü–µ–Ω–∑–∏—è**: MIT
